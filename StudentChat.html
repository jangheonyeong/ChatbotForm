<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>학생용 챗봇</title>
  <link rel="stylesheet" href="StudentChatStyles.css"/>

  <!-- Markdown & 수식 -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.8/dist/purify.min.js"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
  <div class="app">
    <header class="topbar">
      <div class="topbar-inner">
        <a href="StudentLogin.html" class="icon-btn home" title="처음으로" aria-label="처음으로">
          <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor" aria-hidden="true">
            <path d="M12 3l9 8h-3v10h-5V14H11v7H6V11H3l9-8z"></path>
          </svg>
        </a>

        <div class="title-block">
          <h1 id="botTitle">학생용 챗봇</h1>
          <div class="subtitle">
            <span id="subjectLabel"></span>
          </div>
        </div>

        <div class="right-actions">
          <div id="hintButtons" class="hint-buttons" style="display:none;">
            <button id="hintBtn1" class="pill-btn hint-btn" type="button">힌트 1</button>
            <button id="hintBtn2" class="pill-btn hint-btn" type="button">힌트 2</button>
            <button id="hintBtn3" class="pill-btn hint-btn" type="button">힌트 3</button>
          </div>
          <button id="issueCodeBtn" class="pill-btn success" style="display:none;">코드 발급</button>
          <button id="resetThreadBtn" class="icon-btn ghost" title="새로 시작">
            <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor" aria-hidden="true">
              <path d="M12 6V3L8 7l4 4V8c2.76 0 5 2.24 5 5a5 5 0 1 1-8.66-3.66l-1.42-1.42A7 7 0 1 0 19 13c0-3.87-3.13-7-7-7z"></path>
            </svg>
          </button>
        </div>
      </div>

      <div id="codePanel" class="code-panel" style="display:none;">
        <input id="codeText" class="code-text" type="text" readonly placeholder="발급된 코드가 여기에 표시됩니다." />
        <button id="copyCodeBtn" class="pill-btn small">복사</button>
        <span class="hint">24시간 유효</span>
      </div>
    </header>

    <main class="chat">
      <div id="chatWindow" class="chat-window"></div>
    </main>

    <div class="composer-wrap">
      <form id="composer" class="composer" autocomplete="off">
        <div id="fileChips" class="chips"></div>

        <div class="input-row">
          <button id="attachBtn" class="icon-btn attach" type="button" title="파일 첨부" aria-label="파일 첨부">📎</button>
          <input id="fileInput" type="file" multiple hidden
                 accept=".pdf,image/*,.txt,.md,.csv,.tsv,.json,.xml" />
          <textarea id="userMessage" rows="1" placeholder="메시지를 입력하세요. (Enter 전송 · Shift+Enter 줄바꿈)"></textarea>
          <button id="sendBtn" class="icon-btn primary" type="submit" title="보내기" aria-label="보내기">
            <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor" aria-hidden="true">
              <path d="M2 21l21-9L2 3v7l15 2-15 2v7z"></path>
            </svg>
          </button>
        </div>

        <div class="foot-hint">파일(PDF/이미지/텍스트)을 📎로 첨부할 수 있어요.</div>
      </form>
    </div>
  </div>

  <!-- 🔎 이미지 라이트박스 -->
  <div id="lightbox" aria-hidden="true">
    <button id="lightboxClose" class="lb-close" aria-label="닫기">✕</button>
    <img id="lightboxImg" alt="첨부 이미지 미리보기"/>
  </div>

  <script type="module" src="src/StudentChatMain.js"></script>
</body>
</html>
